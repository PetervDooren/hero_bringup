<?xml version="1.0"?>
<launch>

    <group ns="amigo">

        <!-- PARAMETERS: desciption, joint groups and specific skills -->
        <param name="robot_description" textfile="$(find amigo_description)/urdf/amigo.urdf" />
        <rosparam file="$(find amigo_description)/custom/joint_groups.yaml" command="load" />
        <rosparam file="$(find amigo_description)/custom/skills.yaml" command="load" />

        <!-- Robot state publisher -->
        <include file="$(find robot_launch_files)/launch/essentials/robot_state_publisher.launch">
            <arg name="machine" value="amigo1" />
        </include>

        <!-- Phone UI -->
        <include file="$(find robot_launch_files)/launch/interaction/mobile_ui_server.launch">
            <arg name="machine" value="amigo1" />
        </include>

        <!-- Launch simulator if we are not on a real robot -->
        <group unless="$(optenv ROBOT_REAL false)">

			<!-- Simulator -->
			<include file="$(find robot_launch_files)/launch/simulator/simulator.launch" />

			<node name="rgbd_encoder" pkg="rgbd" type="rgbd_server" output="screen">
				<remap from="cam_info" to="/amigo/top_kinect/rgb/camera_info"/>
				<remap from="rgb_image" to="/amigo/top_kinect/rgb/image_color"/>
				<remap from="depth_image" to="/amigo/top_kinect/depth_registered/hw_registered/image_rect_raw"/>
				<remap from="output" to="/amigo/top_kinect/rgbd"/>
				<param name="depth_storage" value="lossless"/>
				<param name="rgb_storage" value="lossless"/>
			</node>

		</group>

		<!-- DIAGNOSTICS -->
		<include file="$(find robot_launch_files)/launch/diagnostics/diagnostics.launch" >
			<arg name="machine" value="amigo1" />
        </include>

    </group>

    <!-- TF Server: advertises services for looking up transformations -->
    <include file="$(find robot_launch_files)/launch/essentials/tf_server.launch" >  
        <arg name="machine" value="amigo1" />
    </include>

 </launch>
